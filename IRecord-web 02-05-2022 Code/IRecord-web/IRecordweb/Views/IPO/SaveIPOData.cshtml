@model IRecordweb.Models.IPO
@{
    ViewBag.Title = "SaveIPOData";
}
@*--------*Angular JS* SECTION------*@
<script src="~/AngScripts/jquery-3.6.0.js"></script>
<script src="~/AngScripts/jquery-3.6.0.min.js"></script>
<script src="~/AngScripts/angular.js"></script>
<script src="~/AngScripts/ngStorage.min.js"></script>
<script src="//angular-ui.github.io/bootstrap/ui-bootstrap-tpls-1.0.3.js"></script>
@*---------*Angular JS* SECTION-----*@
<style>
    .ui-datepicker {
        background: red;
        border: 1px solid #ff0000;
        color: #EEE;
    }

    .input-group .btn {
        position: relative;
        z-index: 1 !important;
    }
</style>

<link href="~/Content/themes/base/jquery-ui.min.css" rel="stylesheet" />
<link href="~/Content/bootstrap.min.v4.css" rel="stylesheet" />
<link href="~/Content/bootstrap-datetimepicker.min.css" rel="stylesheet" />
<link href="~/Content/select2.min.css" rel="stylesheet" />
<link href="~/Content/theme-color.css" rel="stylesheet" />
<link href="~/Content/app.min.css" rel="stylesheet" />
<link href="~/Content/custom-body.css" rel="stylesheet" />

<div class="display_adds display_adds_top text-center mb-3">
    <img src="https://via.placeholder.com/970x90.png/007BFF/FFFFFF?text=Irecord+Ads" alt="">
</div>

<!-- start page title -->
<div class="row">
    <div class="col-12">
        <div class="page-title-box d-flex align-items-center justify-content-between">
            <h1 class="mb-0">Save IPO Data</h1>

            <!-- <div class="page-title-right">
            </div> -->

        </div>
    </div>
</div>
<!-- end page title -->


@using (Html.BeginForm())
{
    @*@Html.AntiForgeryToken()*@

    <!-- Working Area Start -->
    <div class="card">
        <div class="card-body">

            <div class="d-flex flex-column">
                <div class="row mb-3">
                    <div class="col-sm-12 col-md-2 mb-3 d-flex flex-column">
                        <label class="mb-0">Application No:</label>
                        @Html.EditorFor(model => model.ApplicationNo, new { htmlAttributes = new { @class = "form-control" } })
                        @*<input type="text" class="form-control" id="ApplicationNo"/>*@
                    </div>

                    <div class="col-sm-12 col-md-2 mb-3 d-flex flex-column">
                        <label class="mb-0">Application Date:</label>
                        @Html.EditorFor(model => model.TransDate, new { htmlAttributes = new { @class = "form-control datetimepicker", placeholder = "DD-MM-YYYY", autocomplete = "off" } })
                        @*<input type="text" id="TransDate" class="form-control datetimepicker" data-date-format="dd-mm-yyyy" placeholder="DD-MM-YYYY" autocomplete="off" />*@
                    </div>
                    <div class="col-sm-12 col-md-4 mb-3 d-flex flex-column">
                        <label class="mb-0">Holding Type:</label>
                        <select id="mode_type" class="form-select w-100 select2-hide_search">
                            <option value="cash">Share Invesment (Equity) A/C</option>
                            <option value="bank">Share Trading A/C</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="grey_box mb-4">
                <h5 class="mb-2">Basic Details</h5>

                <div class="row">
                    <div class="col-sm-12 col-md-4 mb-3 d-flex flex-column">
                        <label class="mb-0">Broker:</label>
                        <div class="input-group tbl_int_grp">
                            @Html.DropDownListFor(model => model.Broker, ViewBag.Broker as SelectList, "-- Select Broker --", htmlAttributes: new { @class = "form-control form-select select2" })
                            <a style="min-width: 80px;" href="#modal_broker" class="btn btn-outline-primary" data-bs-toggle="modal">
                                <i class="la la-plus"></i> Add
                            </a>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-4 mb-3 d-flex flex-column">
                        <label class="mb-0">Consultant Name:</label>

                        <div class="input-group tbl_int_grp">
                            @Html.DropDownListFor(model => model.Consultant, ViewBag.Consultant as SelectList, "-- Select Consultant --", htmlAttributes: new { @class = "form-control form-select select2" })
                            <a style="min-width: 80px;" href="#modal_consultant" class="btn btn-outline-primary" data-bs-toggle="modal">
                                <i class="la la-plus"></i> Add
                            </a>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-4 mb-3 d-flex flex-column">
                        <label class="mb-0">Demat Name:</label>
                        <div class="input-group tbl_int_grp">
                            @Html.DropDownListFor(model => model.Demat, ViewBag.Demat as SelectList, "-- Select Demat A/C --", htmlAttributes: new { @class = "form-control form-select select2" })
                            <a style="min-width: 80px;" href="#modal_add" class="btn btn-outline-primary" data-bs-toggle="modal">
                                <i class="la la-plus"></i> Add
                            </a>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-6 mb-3 d-flex flex-column">
                        <label class="mb-0">Script:</label>
                        <div class="input-group tbl_int_grp">
                            @Html.DropDownListFor(model => model.ScriptID, ViewBag.ScriptID as SelectList, "-- Select Script --", htmlAttributes: new { @class = "form-control form-select select2" })
                            <a style="min-width: 80px;" href="#modal_add" class="btn btn-outline-primary" data-bs-toggle="modal">
                                <i class="la la-plus"></i> Add
                            </a>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-2 mb-3 d-flex flex-column">
                        <label class="mb-0">Qty:</label>
                        @Html.EditorFor(model => model.Qty, new { htmlAttributes = new { @class = "form-control", placeholder = "Enter Qty" } })
                        @*<input type="text" class="form-control" placeholder="Enter Qty" id="Qty"/>*@
                    </div>
                    <div class="col-sm-12 col-md-2 mb-3 d-flex flex-column">
                        <label class="mb-0">Rate:</label>
                        @Html.EditorFor(model => model.Rate, new { htmlAttributes = new { @class = "form-control", placeholder = "Enter Rate", @onkeyup = "CalAmount();" } })
                        @*<input type="text" class="form-control" placeholder="Enter Rate" id="Rate" onkeyup="CalAmount();" />*@
                    </div>
                    <div class="col-sm-12 col-md-2 mb-3 d-flex flex-column">
                        <label class="mb-0">Amount:</label>
                        @Html.EditorFor(model => model.Amount, new { htmlAttributes = new { @class = "form-control", placeholder = "Enter Amount" } })
                        @*<input type="text" class="form-control"  disabled="" readonly="" id="Amount"/>*@
                    </div>
                </div>
            </div>

            <div class="grey_box mb-4">
                <h5 class="mb-2">Payment</h5>

                <div class="row">
                    <div class="col-sm-12 col-md-4 mb-3 d-flex flex-column">
                        <label class="mb-0">Bank Name:</label>
                        @*<input type="text" class="form-control" placeholder="Enter Bank Name" />*@
                        @Html.DropDownListFor(model => model.Bank, ViewBag.Bank as SelectList, "-- Select Bank --", htmlAttributes: new { @class = "form-control form-select select2" })
                    </div>

                    <div class="col-sm-12 col-md-4 mb-3 d-flex flex-column">
                        <label class="mb-0">Amount:</label>
                        @Html.EditorFor(model => model.TAmount, new { htmlAttributes = new { @class = "form-control", placeholder = "Enter TAmount" } })
                        @*<input type="text" class="form-control" placeholder="Enter Reference No" id="T`Amount"/>*@
                    </div>
                </div>
            </div>

            <div class="grey_box">
                <h5 class="mb-2">
                    <div class="d-flex flex-wrap align-items-center">
                        <div class="form-check d-flex ps-0 pe-4">
                            <input class="form-check-input" type="checkbox" id="check_1">
                            <label class="form-check-label ms-1" for="check_1">Is Allotment?</label>
                        </div>

                        <div class="d-flex">
                            <!-- <label>Date:</label> -->
                            @Html.EditorFor(model => model.AllotedDate, new { htmlAttributes = new { @class = "form-control datepicker", placeholder = "DD-MM-YYYY" } })
                            @*<input type="text" class="form-control datepicker" data-date-format="dd-mm-yyyy" placeholder="DD-MM-YYYY" id="AllotedDate"/>*@
                        </div>
                    </div>
                </h5>

                <div class="row">
                    <div class="col-sm-12 col-md-4 mb-3 d-flex flex-column">
                        <label class="mb-0">Allotment Qty:</label>
                        <div class="d-flex from_to_box">
                            @Html.EditorFor(model => model.AllotedQty, new { htmlAttributes = new { @class = "form-control disabled", placeholder = "Enter Qty", disabled = "" } })
                            @*<input type="text" class="form-control disabled" disabled="" placeholder="Enter Qty" id="AllotedQty"/>*@
                            <span class="bd-gray-400">Rate</span>
                            @Html.EditorFor(model => model.AllotedRate, new { htmlAttributes = new { @class = "form-control disabled", placeholder = "Enter Rate", disabled = "", onkeyup = "CalTotalAmt()" } })
                            @*<input type="text" class="form-control disabled" disabled="" placeholder="Enter Rate" id="AllotedRate" onkeyup="CalTotalAmt()"/>*@
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-2 mb-3 d-flex flex-column disabled">
                        <label class="mb-0">Amount:</label>
                        @Html.EditorFor(model => model.AllotedAmt, new { htmlAttributes = new { @class = "form-control", placeholder = "Enter Amount" } })
                        @*<input type="text" class="form-control disabled" value="00.00" disabled="" id="AllotedAmt" />*@
                    </div>
                </div>
            </div>

            <div class="col-sm-12 text-center mt-3">
                <input type="submit" class="btn btn-primary" value="Save" />

            </div>

        </div>
    </div>
}
<div class="pagination_box w-100 mb-3 d-sm-flex justify-content-end">
    @*<div class="float-sm-end">
            <uib-pagination class="pagination MYPAGECSS" total-items="AllMember.length" ng-model="page"
                            ng-change="pageChanged()" previous-text="&lsaquo;" next-text="&rsaquo;" items-per-page=10></uib-pagination>
        </div>*@
</div>

<div class="table-responsive table-small">
    @if (Model != null)
    {
        <table class="table defaultTable table-hover table-bordered mb-0">
            <thead class="table-light">
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.TransactionId)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.ApplicationNo)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Qty)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Rate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Amount)
                    </th>
                </tr>
            </thead>

            @foreach (var item in Model.Showipo)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.TransactionId)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.ApplicationNo)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Qty)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Rate)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Amount)
                    </td>
                </tr>
            }
        </table>
        }
    </div>

<!-- Working Area End -->
<!-- Modal 1 -->
<div class="modal fade" id="modal_add" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Add Demat</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row form_2">
                    <div class="col-sm-12 col-md-6 mb-3 d-flex">
                        <label class="mb-0">Demat <span class="text-danger">*</span>:</label>
                        <input type="text" id="family_name" name="family_name" class="form-control" placeholder="Enter Demat A/c Name" />
                    </div>
                </div>
            </div>
            <div class="modal-footer justify-content-center">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Save</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Reset</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal 2 -->
<div class="modal fade" id="modal_consultant" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Add Consultant</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row form_2">
                    <div class="col-sm-12 col-md-6 mb-3 d-flex">
                        <label class="mb-0">Consultant <span class="text-danger">*</span>:</label>
                        <input type="text" id="family_name" name="family_name" class="form-control" placeholder="Enter Consultant Name" />
                    </div>
                </div>
            </div>
            <div class="modal-footer justify-content-center">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Save</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Reset</button>
            </div>
        </div>
    </div>
</div>
<!-- Modal 3 -->
<div class="modal fade" id="modal_broker" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Add Broker</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row form_2">
                    <div class="col-sm-12 col-md-6 mb-3 d-flex">
                        <label class="mb-0">Broker <span class="text-danger">*</span>:</label>
                        <input type="text" id="family_name" name="family_name" class="form-control" placeholder="Enter Broker Name" />
                    </div>
                </div>
            </div>
            <div class="modal-footer justify-content-center">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Save</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Reset</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script src="~/Scripts/jquery-ui-1.12.1.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/jquery-1.12.4.js"></script>
    <script src="~/Scripts/jquery-1.12.4.min.js"></script>
    <script src="~/js/select2.min.js"></script>

    @if (ViewBag.Message != null)
    {
        <script type="text/javascript">
            window.onload = function () {
                alert('@ViewBag.Message');
            };
        </script>
    }

    <script>
        $(document).ready(function () {
            $("#TransDate").datepicker({
                dateFormat: "dd/mm/yy",
                changeMonth: true,
                changeYear: true,
            });

            $(".select2").select2({
                maximumSelectionLength: 3
            });
            $(".select2-hide_search").select2({
                minimumResultsForSearch: Infinity
            });
        });


        $(document).ready(function () {
            $("#AllotedDate").datepicker({
                dateFormat: "dd/mm/yy",
                changeMonth: true,
                changeYear: true,
            });
        });
    </script>
    <script>
        function CalAmount() {
            var Qty = document.getElementById('Qty').value;
            var Rate = document.getElementById('Rate').value;
            var Amount = document.getElementById('Amount').value;
            var TAmount = Qty * Rate;
            document.getElementById('Amount').value = TAmount;
            document.getElementById('Amount').disabled = true;
        }

        function CalTotalAmt() {
            var AllotedQty = document.getElementById('AllotedQty').value;
            var AllotedRate = document.getElementById('AllotedRate').value;
            var AllotedAmt = document.getElementById('AllotedAmt').value;
            var TAmount = AllotedQty * AllotedRate;
            document.getElementById('AllotedAmt').value = TAmount;
            document.getElementById('AllotedAmt').disabled = true;
        }

        document.getElementById('check_1').onchange = function () {
            document.getElementById('AllotedQty').disabled = !this.checked;
            document.getElementById('AllotedRate').disabled = !this.checked;
            document.getElementById('AllotedAmt').disabled = !this.checked;
        };

    </script>
}





